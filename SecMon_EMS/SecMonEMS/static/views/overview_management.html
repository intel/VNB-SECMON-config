<div class="main">

  <h1 class="page-header">{{title}}</h1>

  <div class="tabs">
    <ul class="nav nav-tabs responsive nav-justified role="tablist"">
      <li class="nav-item">
        <a class="nav-link active" ng-click="tab = 1" data-toggle="tab" href="secmon_scope" role="tab">Scope</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" ng-click="tab = 2" data-toggle="tab" href="classification_object" role="tab">Classification Object</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" ng-click="tab = 3" data-toggle="tab" href="rule_object" role="tab">Rule Object</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" ng-click="tab = 4" data-toggle="tab" href="policy" role="tab">Policy</a>
      </li>
    </ul>

    <div class="tab-content">
      <div class="tab-pane active" id="secmon_scope" ng-show="tab==1">
        <h4>Scope</h4>

        <div class="rbac_main_buttons">

          <md-input-container md-no-float style="margin-bottom: 0px;">
           <input ng-model="searchText1" id="search_text_inp" placeholder="Search">
         </md-input-container>
         <md-button class="md-primary md-raised create_scope_button" ng-click="flushDialog($event)"  >
           <i class="fa fa-trash"></i>Flush
         </md-button>
         <md-button class="md-primary md-raised create_scope_button" ng-click="createScopeDialog($event)"  >
           <i class="fa fa-plus"></i>Create
         </md-button>
         <md-button class="md-primary md-raised btn-danger" ng-click="selectedScopeDelete($event)" >
           <i class="fa fa-trash"></i>Delete
         </md-button>

       </div>

       <div class="table-responsive" id="scope_list_div">
        <table class="table table-striped table-bordered table-hover footable toggle-medium">
          <thead>
            <tr>
              <th></th>
              <th>
                <a href ng-click="sortType = 'name'; sortReverse
                = !sortReverse">Scope Name</a>
                <span ng-show="sortType == 'name' && !sortReverse" class="fa fa-caret-down"></span>
                <span ng-show="sortType == 'name' && sortReverse" class="fa fa-caret-up"></span>
              </th>
			  <!-- Uncomment code below if need SFlow component in GUI -->
              <!-- <th>
                <a href ng-click="sortType = 'sflowstatus'; sortReverse = !sortReverse">
                  SFlow Status</a>
                  <span ng-show="sortType == 'sflowstatus' && !sortReverse" class="fa fa-caret-down"></span>
                  <span ng-show="sortType == 'sflowstatus' && sortReverse" class="fa fa-caret-up"></span>
                </th>
				-->
                <th>
                  <a href ng-click="sortType = 'netflowstatus'; sortReverse = !sortReverse">
                    NetFlow Status</a>
                    <span ng-show="sortType == 'netflowstatus' && !sortReverse" class="fa fa-caret-down"></span>
                    <span ng-show="sortType == 'netflowstatus' && sortReverse" class="fa fa-caret-up"></span>
                  </th>
                  <th>
                    <a href ng-click="sortType = 'rawforwardstatus'; sortReverse = !sortReverse">
                      RawForward Status</a>
                      <span ng-show="sortType == 'rawforwardstatus' && !sortReverse" class="fa fa-caret-down"></span>
                      <span ng-show="sortType == 'rawforwardstatus' && sortReverse" class="fa fa-caret-up"></span>
                    </th>
                    <th>
                      Action
                    </th>
                  </tr>
                </thead>
                <tbody>
                  <tr ng-repeat="scope in available_scopes | filter:searchText1 | orderBy:sortType:sortReverse">
                    <td><input type="checkbox" ng-model="selected[scope.id]"></input>
						<td>{{ scope.name}}</td>
						<!-- Uncomment code below if need SFlow component in GUI -->
						<!-- <td>{{ scope.sflowstatus}}</td> -->
						<td>{{ scope.netflowstatus}}</td>
						<td>{{ scope.rawforwardstatus}}</td>
						<td>
                        <div class="btn-group">
                          <md-menu>
                            <md-button class="md-raised md-primary
                            actions_buttons"
                            ng-click="$mdOpenMenu($event)">Select Action<span class="caret"></span></md-button>
                            <md-menu-content width="4">
                              <md-menu-item>
                                <md-button ng-click="editScope($event, 'scope', scope.id)">
                                  Edit Scope
                                </md-button>
                              </md-menu-item>
                            </md-menu-content>
                          </md-menu>
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>

            <div class="tab-pane active" id="classification_object" ng-show="tab==2">
              <h4>Classification Object</h4>
              <div class="rbac_main_buttons">

                <md-input-container md-no-float style="margin-bottom: 0px;">
                 <input ng-model="searchText2" id="search_text_inp" placeholder="Search">
               </md-input-container>

               <md-button class="md-primary md-raised create_scope_button" ng-click="createClassificationObjectDialog($event)"  >
                 <i class="fa fa-plus"></i>Create
               </md-button>
               <md-button class="md-primary md-raised btn-danger" ng-click="selectedClassificationObjectDelete($event)" >
                 <i class="fa fa-trash"></i>Delete
               </md-button>

             </div>
             <div class="table-responsive" id="scope_list_div">
              <table class="table table-striped table-bordered table-hover footable toggle-medium">
                <thead>
                  <tr>
                    <th></th>
                    <th>
                      <a href ng-click="sortType = 'name'; sortReverse = !sortReverse">
                        Classification Object Name</a>
                        <span ng-show="sortType == 'name' && !sortReverse" class="fa fa-caret-down"></span>
                        <span ng-show="sortType == 'name' && sortReverse" class="fa fa-caret-up"></span>
                      </th>
                      <th>
                        <a href ng-click="sortType = 'src_ip'; sortReverse = !sortReverse">
                          Source IP Address</a>
                          <span ng-show="sortType == 'src_ip' && !sortReverse" class="fa fa-caret-down"></span>
                          <span ng-show="sortType == 'src_ip' && sortReverse" class="fa fa-caret-up"></span>
                        </th>
                        <th>
                          <a href ng-click="sortType = 'src_mac'; sortReverse = !sortReverse">
                            Source Mac</a>
                            <span ng-show="sortType == 'src_mac' && !sortReverse" class="fa fa-caret-down"></span>
                            <span ng-show="sortType == 'src_mac' && sortReverse" class="fa fa-caret-up"></span>
                          </th>
                          <th>
                            <a href ng-click="sortType = 'src_ip_subnet'; sortReverse = !sortReverse">
                              Source Subnet</a>
                              <span ng-show="sortType == 'src_ip_subnet' && !sortReverse" class="fa fa-caret-down"></span>
                              <span ng-show="sortType == 'src_ip_subnet' && sortReverse" class="fa fa-caret-up"></span>
                            </th>
                            <th>
                              <a href ng-click="sortType = 'minimum_src_port'; sortReverse = !sortReverse">
                                Minimum Source Port</a>
                                <span ng-show="sortType == 'minimum_src_port' && !sortReverse" class="fa fa-caret-down"></span>
                                <span ng-show="sortType == 'minimum_src_port' && sortReverse" class="fa fa-caret-up"></span>
                              </th>
                              <th>
                                <a href ng-click="sortType = 'maximum_src_port'; sortReverse = !sortReverse">
                                  Maximum Source Port</a>
                                  <span ng-show="sortType == 'maximum_src_port' && !sortReverse" class="fa fa-caret-down"></span>
                                  <span ng-show="sortType == 'maximum_src_port' && sortReverse" class="fa fa-caret-up"></span>
                                </th>
                                <th>
                                  <a href ng-click="sortType = 'dst_ip'; sortReverse = !sortReverse">
                                    Destination IP Address</a>
                                    <span ng-show="sortType == 'dst_ip' && !sortReverse" class="fa fa-caret-down"></span>
                                    <span ng-show="sortType == 'dst_ip' && sortReverse" class="fa fa-caret-up"></span>
                                  </th>
                                  <th>
                                    <a href ng-click="sortType = 'dst_mac'; sortReverse = !sortReverse">
                                      Destination Mac</a>
                                      <span ng-show="sortType == 'dst_mac' && !sortReverse" class="fa fa-caret-down"></span>
                                      <span ng-show="sortType == 'dst_mac' && sortReverse" class="fa fa-caret-up"></span>
                                    </th>
                                    <th>
                                      <a href ng-click="sortType = 'dst_ip_subnet'; sortReverse = !sortReverse">
                                        Destination Subnet</a>
                                        <span ng-show="sortType == 'dst_ip_subnet' && !sortReverse" class="fa fa-caret-down"></span>
                                        <span ng-show="sortType == 'dst_ip_subnet' && sortReverse" class="fa fa-caret-up"></span>
                                      </th>
                                      <th>
                                        <a href ng-click="sortType = 'minimum_dst_port'; sortReverse = !sortReverse">
                                          Minimum Destination Port</a>
                                          <span ng-show="sortType == 'minimum_dst_port' && !sortReverse" class="fa fa-caret-down"></span>
                                          <span ng-show="sortType == 'minimum_dst_port' && sortReverse" class="fa fa-caret-up"></span>
                                        </th>
                                        <th>
                                          <a href ng-click="sortType = 'maximum_dst_port'; sortReverse = !sortReverse">
                                            Maximum Destination Port</a>
                                            <span ng-show="sortType == 'maximum_dst_port' && !sortReverse" class="fa fa-caret-down"></span>
                                            <span ng-show="sortType == 'maximum_dst_port' && sortReverse" class="fa fa-caret-up"></span>
                                          </th>
                                          <th>
                                            <a href ng-click="sortType = 'protocol'; sortReverse = !sortReverse">
                                              Protocol</a>
                                              <span ng-show="sortType == 'protocol' && !sortReverse" class="fa fa-caret-down"></span>
                                              <span ng-show="sortType == 'protocol' && sortReverse" class="fa fa-caret-up"></span>
                                            </th>
                                            <th>
                                              Action
                                            </th>
                                          </tr>
                                        </thead>
                                        <tbody>
                                          <tr ng-repeat="classificationobject in available_classificationobjects | filter:searchText2 | orderBy:sortType:sortReverse">
                                            <td><input type="checkbox" ng-model="selected[classificationobject.id]"></input>
                                              <td>{{classificationobject.name}}</td>
                                              <td>{{ classificationobject.src_ip}}</td>
                                              <td>{{ classificationobject.src_mac}}</td>
                                              <td>{{ classificationobject.src_ip_subnet}}</td>
                                              <td>{{ classificationobject.minimum_src_port}}</td>
                                              <td>{{ classificationobject.maximum_src_port}}</td>
                                              <td>{{ classificationobject.dst_ip}}</td>
                                              <td>{{ classificationobject.dst_mac}}</td>
                                              <td>{{ classificationobject.dst_ip_subnet}}</td>
                                              <td>{{ classificationobject.minimum_dst_port}}</td>
                                              <td>{{ classificationobject.maximum_dst_port}}</td>
                                              <td>{{ classificationobject.protocol}}</td>
                                              <td>
                                                <div class="btn-group">
                                                  <md-menu>
                                                    <md-button class="md-raised md-primary actions_buttons" ng-click="$mdOpenMenu($event)">Select action<span class="caret"></span></md-button>
                                                    <md-menu-content width="4">
                                                      <md-menu-item>
                                                        <md-button ng-click="editClassificationObject($event, 'classificationobject', classificationobject.id)">
                                                          Edit Classification Object
                                                        </md-button>
                                                      </md-menu-item>
                                                    </md-menu-content>
                                                  </md-menu>
                                                </div>
                                              </td>
                                            </tr>
                                          </tbody>
                                        </table>
                                      </div>
                                    </div>

                                    <div class="tab-pane active" id="rule_object" ng-show="tab==3">
                                      <h4>Rule Object</h4>

                                      <div class="rbac_main_buttons">

                                        <md-input-container md-no-float style="margin-bottom: 0px;">
                                         <input ng-model="searchText3" id="search_text_inp" placeholder="Search">
                                       </md-input-container>

                                       <md-button class="md-primary md-raised create_scope_button" ng-click="createRuleObjectDialog($event)"  >
                                         <i class="fa fa-plus"></i>Create
                                       </md-button>
                                       <md-button class="md-primary md-raised btn-danger" ng-click="selectedRuleObjectDelete($event)" >
                                         <i class="fa fa-trash"></i>Delete
                                       </md-button>

                                     </div>

                                     <div class="table-responsive" id="scope_list_div">
                                      <table class="table table-striped table-bordered table-hover footable toggle-medium">
                                        <thead>
                                          <tr>
                                            <th></th>
                                            <th>
                                              <a href ng-click="sortType = 'name'; sortReverse = !sortReverse">
                                                Rule Object Name</a>
                                                <span ng-show="sortType == 'name' && !sortReverse" class="fa fa-caret-down"></span>
                                                <span ng-show="sortType == 'name' && sortReverse" class="fa fa-caret-up"></span>
                                              </th>
                                              <th>
                                                <a href ng-click="sortType = 'classificationobject_id'; sortReverse = !sortReverse">
                                                  Classification Object</a>
                                                  <span ng-show="sortType == 'classificationobject_id' && !sortReverse" class="fa fa-caret-down"></span>
                                                  <span ng-show="sortType == 'classificationobject_id' && sortReverse" class="fa fa-caret-up"></span>
                                                </th>
                                                <th>
                                                  <a href ng-click="sortType = 'priority'; sortReverse = !sortReverse">
                                                    Priority</a>
                                                    <span ng-show="sortType == 'priority' && !sortReverse" class="fa fa-caret-down"></span>
                                                    <span ng-show="sortType == 'priority' && sortReverse" class="fa fa-caret-up"></span>
                                                  </th>
                                                  <th>
                                                    <a href ng-click="sortType = 'truncate_to_size'; sortReverse = !sortReverse">
                                                      Truncate to Size</a>
                                                      <span ng-show="sortType == 'truncate_to_size' && !sortReverse" class="fa fa-caret-down"></span>
                                                      <span ng-show="sortType == 'truncate_to_size' && sortReverse" class="fa fa-caret-up"></span>
                                                    </th>
                                                    <th>
                                                      <a href ng-click="sortType = 'action'; sortReverse = !sortReverse">
                                                        Packet Action</a>
                                                        <span ng-show="sortType == 'action' && !sortReverse" class="fa fa-caret-down"></span>
                                                        <span ng-show="sortType == 'action' && sortReverse" class="fa fa-caret-up"></span>
                                                      </th>
                                                      <th>
                                                        Action
                                                      </th>
                                                    </tr>
                                                  </thead>
                                                  <tbody>
                                                    <tr ng-repeat="ruleobject in available_ruleobjects | filter:searchText3 | orderBy:sortType:sortReverse">
                                                      <td><input type="checkbox" ng-model="selected[ruleobject.id]"></input>
                                                        <td>{{ ruleobject.name}}</td>
                                                        <td>{{ ruleobject.classificationobject_id}}</td>
                                                        <td>{{ ruleobject.priority}}</td>
                                                        <td>{{ ruleobject.truncate_to_size}}</td>
                                                        <td>{{ ruleobject.action}}</td>
                                                        <td>
                                                          <div class="btn-group">
                                                            <md-menu>
                                                              <md-button class="md-raised md-primary
                                                              actions_buttons"
                                                              ng-click="$mdOpenMenu($event)">Select Action<span class="caret"></span></md-button>
                                                              <md-menu-content width="4">
                                                                <md-menu-item>
                                                                  <md-button ng-click="editRuleObject($event, 'ruleobject', ruleobject.id)">
                                                                    Edit Rule Object
                                                                  </md-button>
                                                                </md-menu-item>
                                                              </md-menu-content>
                                                            </md-menu>
                                                          </div>
                                                        </td>
                                                      </tr>
                                                    </tbody>
                                                  </table>
                                                </div>
                                              </div>
                                              <div class="tab-pane active" id="policy" ng-show="tab==4">
                                                <h4>Policy</h4>

                                                <div class="rbac_main_buttons">

                                                  <md-input-container md-no-float style="margin-bottom: 0px;">
                                                   <input ng-model="searchText4" id="search_text_inp" placeholder="Search">
                                                 </md-input-container>

                                                 <md-button class="md-primary md-raised create_scope_button" ng-click="createPolicyDialog($event)"  >
                                                   <i class="fa fa-plus"></i>Create
                                                 </md-button>
                                                 <md-button class="md-primary md-raised btn-danger" ng-click="selectedPolicyDelete($event)" >
                                                   <i class="fa fa-trash"></i>Delete
                                                 </md-button>

                                               </div>

                                               <div class="table-responsive" id="scope_list_div">
                                                <table class="table table-striped table-bordered table-hover footable toggle-medium">
                                                  <thead>
                                                    <tr>
                                                      <th></th>
                                                      <th>
                                                        <a href ng-click="sortType = 'name'; sortReverse = !sortReverse">
                                                          Policy Name</a>
                                                          <span ng-show="sortType == 'name' && !sortReverse" class="fa fa-caret-down"></span>
                                                          <span ng-show="sortType == 'name' && sortReverse" class="fa fa-caret-up"></span>
                                                        </th>
                                                        <th>
                                                          <a href ng-click="sortType = 'ruleobject_id'; sortReverse = !sortReverse">
                                                            Rule Objects</a>
                                                            <span ng-show="sortType == 'ruleobject_id' && !sortReverse" class="fa fa-caret-down"></span>
                                                            <span ng-show="sortType == 'ruleobject_id' && sortReverse" class="fa fa-caret-up"></span>
                                                          </th>
                                                          <th>
                                                            Action
                                                          </th>
                                                        </tr>
                                                      </thead>
                                                      <tbody>
                                                        <tr ng-repeat="policy in available_policys | filter:searchText4 | orderBy:sortType:sortReverse">
                                                          <td><input type="checkbox" ng-model="selected[policy.id]"></input>
                                                            <td>{{ policy.name}}</td>
                                                            <td>{{ policy.ruleobject_id}}</td>
                                                            <td>
                                                              <div class="btn-group">
                                                                <md-menu>
                                                                  <md-button class="md-raised md-primary actions_buttons" ng-click="$mdOpenMenu($event)">Select action<span class="caret"></span></md-button>
                                                                  <md-menu-content width="4">
                                                                    <md-menu-item>
                                                                      <md-button ng-click="editPolicy($event, 'policy', policy.id)">
                                                                        Edit Policy
                                                                      </md-button>
                                                                    </md-menu-item>
                                                                  </md-menu-content>
                                                                </md-menu>
                                                              </div>
                                                            </td>
                                                          </tr>
                                                        </tbody>
                                                      </table>
                                                    </div>
                                                  </div>
                                                </div>
                                              </div>
                                            </div>
